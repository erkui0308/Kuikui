<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>解忧杂货铺</title>
    <script src="assets/jquery.min.js?v=3.3.1"></script>
    <script src="assets/jquery-ui.min.js?v=1.12.1"></script>
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/swiper.css">
    <style>
        header {
            background-color: black;
            text-align: center;
            position: fixed;
            width: 100%;
            z-index: 999;
        }
        /* .box{
            padding-top: 113px;
        } */
        .m-tabct {
            display: none;
            position: absolute;
            top: 113px;
            bottom: 0;
            left: 0;
            right: 0;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <div class="swiper-container">
        <div class="swiper-wrapper" >
            <div class="swiper-slide content" >
                <!-- content -->
                <div class="m-tabarea m-tabarea-index">
                    <header>
                        <canvas id="myCanvas" width="300" height="60" style="border: 6px solid black;">
                        </canvas>
                    </header>
                    <div class="utab-header">
                        <nav class="u-tab mrc-tab f-bd f-bd-btm f-bd f-bd-btm"><a class="tabtitle z-selected">
                                <div class="tabtxt"><span class="tt"><em class="tt_word">推荐音乐</em></span></div>
                            </a><a class="tabtitle">
                                <div class="tabtxt"><span class="tt"><em class="tt_word">热歌榜</em></span></div>
                            </a><a class="tabtitle">
                                <div class="tabtxt"><span class="tt"><em class="tt_word">搜索</em></span></div>
                            </a></nav>
                    </div>
                    <div class="box">
                        <div class="m-tabct" style="display: block;">
                            <div class="tabctitem">
                                <div class="m-homeremd">
                                    <h2 class="remd_tl">推荐歌单</h2>
                                    <div class="remd_songs">
                                        <div class="remd_ul">

                                        </div>
                                    </div>
                                    <h2 class="remd_tl">最新音乐</h2>
                                    <div class="remd_newsg">
                                        <div class="m-sglst" style="padding-bottom: 127px;">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="m-tabct">
                            <div class="tabctitem">
                                <div class="m-hmhot">
                                    <div class="hottime">更新日期：01月21日</div>
                                    <div class="hotcont">
                                        <div class="m-sglst">
                                            <a class="m-sgitem" href="">
                                                <div class="sgfl sgfl-cred">01</div>
                                                <div class="sgfr f-bd f-bd-btm">
                                                    <div class="sgchfl">
                                                        <div class="f-thide sgtl">四季予你</div>
                                                        <div class="f-thide sginfo">
                                                            <i class="u-hmsprt sghot"></i>
                                                            程响 -四季予你
                                                        </div>
                                                    </div>
                                                    <div class="sgchfr">
                                                        <span class="u-hmsprt sgchply">
                                                        </span>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="hotdn"><span class="hotview">查看完整榜单</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="m-tabct">
                            <div class="tabctitem">
                                <div class="m-hmsrch">
                                    <form class="m-input f-bd f-bd-btm" method="get" action="#">
                                        <div class="inputcover"><i class="u-svg u-svg-srch"></i><input type="search"
                                                name="search" class="input" placeholder="" autocomplete="off"
                                                value=""><label class="holder">搜索歌曲、歌手、专辑</label>
                                            <figure class="close"><i class="u-svg u-svg-empty"></i></figure>
                                        </div>
                                    </form>
                                    <div class="m-default">
                                        <section class="m-hotlist">
                                            <h3 class="title">热门搜索</h3>
                                            <ul class="list">
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">华晨宇</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">张碧晨</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">是你想成为的大人吗</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">斗牛</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">星辰大海</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">错位时空</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">你的轮廓</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">凉凉</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">不仅自己可见</a></li>
                                                <li class="item f-bd f-bd-full"><a class="link"
                                                        href="javascript:void(0);">我们</a></li>
                                            </ul>
                                        </section>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="menu-button">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                </div>
            </div>
            <div class="swiper-slide menu" >
                <!-- content-c -->
            </div>
        </div>
    </div>
    <script src="./js/watch.js"></script>
    <script src="./js/swiper.js"></script>
    <script src="./js/tab.js"></script>
    <script>
        // watch
        quanju()
        setInterval(function () {
            quanju()
        }, 10);
        // tab
        tab('.tabtitle', '.box .m-tabct')
        // --
        try {
            $("<link>").attr({
                href: "assets/waifu.min.css?v=1.4.2",
                rel: "stylesheet",
                type: "text/css"
            }).appendTo('head');
            $('body').append(
                `<div class="waifu"><div class="waifu-tips"></div>
                                    <canvas id="live2d" class="live2d"></canvas>
                                    <div class="waifu-tool">
                                        <span class="fui-chat"></span> 
                                        <span class="fui-cross"></span>
                                    </div>
                                </div>`);
            $.ajax({
                url: 'assets/waifu-tips.min.js?v=1.4.2',
                dataType: "script",
                cache: true,
                async: false
            });
            $.ajax({
                url: 'assets/live2d.min.js?v=1.0.5',
                dataType: "script",
                cache: true,
                async: false
            });
            /* 可直接修改部分参数 */
            live2d_settings['hitokotoAPI'] = 'hitokoto.cn'; // 一言 API
            live2d_settings['modelId'] = 6; // 默认模型 ID
            live2d_settings['modelTexturesId'] = 15; // 默认材质 ID
            live2d_settings['modelStorage'] = false; // 不储存模型 ID
            live2d_settings['waifuDraggableRevert'] = false; // 松开鼠标还原拖拽位置，可选 true(真), false(假)
            /* 在 initModel 前添加 */
            initModel('assets/waifu-tips.json');
        } catch (err) {
            console.log('[Error] JQuery is not defined.')
        }
        // --
        var menuButton = document.querySelector('.menu-button');
        var openMenu = function () {
            swiper.slideNext();
        };
        var swiper = new Swiper('.swiper-container', {
            initialSlide: 0,
            effect: 'fade',
            slidesPerView: 'auto',
            resistanceRatio: 0,
            slideToClickedSlide: true,
            on: {
                slideChangeTransitionStart: function () {
                    if (this.activeIndex === 1) {
                        alert(this.activeIndex)
                        menuButton.classList.add('cross');
                        menuButton.removeEventListener('click', openMenu, true);
                    } else {
                        alert(this.activeIndex)
                        menuButton.classList.remove('cross');
                    }
                },
                slideChangeTransitionEnd: function () {
                    if (this.activeIndex === 0) {
                        menuButton.addEventListener('click', openMenu, true);
                    }
                },
            }
        });

        var api = 'https://musicapi.leanapp.cn'

        // ---推荐
        $.ajax({
            type: "GET",
            url: api + "/personalized?limit=6",
            dataType: "json",
            success: function (data) {
                let str = ''
                var Tjdata = data.result
                if (data.code == 200) {
                    for (var i = 0; i < Tjdata.length; i++) {
                        str += "<a class='remd_li'href='#'>"
                        str += "<div class='remd_img'>"
                        str += "<img class='u-img' src=" + Tjdata[i].picUrl + ">"
                        str += "<span class='u-earp remd_lnum'>" + Tjdata[i].playCount +
                            "</span>"
                        str += "</div>"
                        str += "<p class='remd_text'>" + Tjdata[i].name + "</p>"
                        str += "</a>"
                    }
                    document.querySelector(".remd_ul").innerHTML = str;
                } else {
                    alert('api崩溃')
                }

            },
        });
        // ---最新
        $.ajax({
            type: "GET",
            url: api + "/personalized/newsong",
            dataType: "json",
            success: function (data) {
                let Zxstr = ''
                var Zxdata = data.result
                console.log(Zxdata)
                if (data.code == 200) {
                    for (var i = 0; i <= 5; i++) {
                        console.log(Zxdata[i])
                        Zxstr += '<a class="m-sgitem" href="player.html?id='+ Zxdata[i].id +'"style="color: black;">'
                        Zxstr += '<div class="sgfr f-bd f-bd-btm">'
                        Zxstr += '<div class="sgchfl">'
                        Zxstr += '<div class="f-thide sgtl">' + Zxdata[i].name + '</div>'
                        Zxstr += '<div class="f-thide sginfo">'
                        Zxstr += Zxdata[i].song.artists[0].name
                        Zxstr += '-'
                        Zxstr += Zxdata[i].name
                        Zxstr += '</div>'
                        Zxstr += '</div>'
                        Zxstr +=
                            '<div class="sgchfr"><span class="u-hmsprt sgchply"></span></div>'
                        Zxstr += '</div>'
                        Zxstr += '</a>'
                    }
                    document.querySelector(".m-sglst").innerHTML = Zxstr;
                } else {
                    alert('api崩溃')
                }
            },
        });
    </script>
</body>

</html>